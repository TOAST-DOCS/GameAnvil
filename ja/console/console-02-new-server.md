## Game > GameAnvil > コンソール使用ガイド > サーバーを作成する

## GameAnvilメニューとタブ

GameAnvilコンソールは上位のメニューに大きな機能が分かれており、各メニューは下位のタブで構成されています。例えば、**モニタリング**、**サーバー**、**運用**はメニューです。 そしてモニタリングメニューは**ダッシュボード**、**サーバー現況**、**ユーザー分布**、**オートスケールグループ**でタブで構成されます。

![図](https://static.toastoven.net/prod_gameanvil/images/console/new-server/menu-server-manage-1.png)

**サーバー**メニューは**サーバー**、**オートスケールグループ**、**ノード**、**配布ファイル**、**Config**タブで構成されています。

![図](https://static.toastoven.net/prod_gameanvil/images/console/new-server/menu-server-manage-2.png)

**運営**メニューは**実行**、**履歴**タブで構成されます。

![図](https://static.toastoven.net/prod_gameanvil/images/console/new-server/menu-server-manage-3.png)

この文書はこれらのメニューとタブの機能を中心に説明します。


## サーバー作成のための準備

サーバーを作成するには、少なくともサーバーバイナリと関連設定及びデータなどが必要です。コンソールでは、このためにサーバーメニューの配布ファイルとConfigタブを提供します。 

配布ファイルタブにゲームサーバーのバイナリをアップロードできます。アップロードしたバイナリは下の画面のように履歴が管理されます。サーバーを作成する時、このような配布ファイルのいずれかを選択して各インスタンスに自動配布されます。 
![図](https://static.toastoven.net/prod_gameanvil/images/console/new-server/deploy.png)

配布ファイルと同じように、サーバーを駆動するための構成情報(Config)を登録する必要があります。 これにより、サーバーのバイナリをどのような設定に基づいて駆動するかを決めることができます。このような構成ファイルも次の画面のようにその内訳が別途管理されます。

![図](https://static.toastoven.net/prod_gameanvil/images/console/new-server/config.png)

構成情報(Config)を登録する方法は大きく2つあります。1つ目は、下の画面のようにあらかじめ作成されたJSONファイルをアップロードする方式です。 この時、初めて構成情報(Config)ファイルを作成する場合、Configテンプレートのダウンロードをクリックしてテンプレートをダウンロードして使うことができます。

![図](https://static.toastoven.net/prod_gameanvil/images/console/new-server/config-new.png)

2つ目は下の画面のように編集ウィンドウを利用して直接構成情報を入力する方法です。 登録方法以外には違いがないので、好きな方法を選択して構成情報を登録します。

![図](https://static.toastoven.net/prod_gameanvil/images/console/new-server/config-edit.png)

登録した配布ファイルと構成ファイルはリストだけでなく、履歴タブで今までの全ての履歴を照会することもできます。


## サーバー作成する

前の過程で配布ファイルとConfigファイルが正常に登録されたら、サーバーを作成できます。サーバーは実際のサービスだけでなく、テストや開発など好きな用途で使うことができます。

サーバーを作成するには、コンソールのサーバーメニューでサーバー作成をクリックしてください。

![図](https://static.toastoven.net/prod_gameanvil/images/console/new-server/create-01.png)


下記のようにサーバー作成ページが表示されます。この文書のサーバー基本情報、ノード構成の内容を参考にしてサーバーを作成してください。

![図](https://static.toastoven.net/prod_gameanvil/images/console/new-server/create-new.png)


## サーバー基本情報

![図](https://static.toastoven.net/prod_gameanvil/images/console/new-server/create-03.png)

* サーバー名：現在構成するサーバーを表す固有の識別子を指定します。同じ識別子を持つサーバーを複数台起動する場合は、その識別子の後に1から1ずつ増加する固有の番号が追加されます。

* サーバー数：起動するサーバーの数を設定します。 

* インスタンスタイプ：作成するサーバーインスタンスのタイプを選択します。

* 配布ファイル：サーバーを起動するためにアップロードされたサーバーバイナリを選択します。選択する前に少なくとも1つ以上のサーバーバイナリがアップロードされている必要があります。 配布ファイルタブでサーバーバイナリを管理できます。

* タグ：サーバー構成に任意のタグを作成しておくことができます。

* メモ：該当サーバーに関する簡単なメモを作成できます。このメモはサーバーの構成や運営に影響を与える値ではありません。

## ノード構成

GameAnvilのノードはゲームサーバーの機能単位です。開発が完了したサーバーバイナリには、ゲームで使用するあらゆる種類のノードの実装が含まれています。このようなバイナリログで駆動されるサーバープロセスは、設定によって任意の選択されたノードのみで構成することができ、サーバー作成前に登録しておいた構成情報(Config)を基に設定します。 つまり、構成情報(Config)にはノード構成情報が含まれています。複数の構成情報(Config)が登録されている場合、適用する構成をリストから選択できます。 また、構成情報に含まれているノード設定をノードの種類別に有効または無効にできます。

![図](https://static.toastoven.net/prod_gameanvil/images/console/new-server/create-04.png)


上の画像は、次のように合計4つのゲームノードでサーバーを構成します。

| ノード種類  | サービス名   | 駆動数 | 説明                                           |
|---------|---------|-------|-----------------------------------------------|
| GAME    | RPSGame | 4     | ゲームコンテンツが実装されたゲームノードで、それぞれch1～ch4までのチャンネルを担当します。 |



この時、構成情報(Config)に入力したサービス名はサーバー開発に使用された情報と同じでなければなりません。サーバーの実装に使用された情報と異なる値を入力した場合、サーバーが正常に動作しません。 チャネル値も構成情報(Config)に設定した値がそのまま表示されます。

サーバーの作成と同時に自動的にサーバーを起動する場合は、チェックボックスをクリックしてチェックします。デフォルト値(作成と同時に起動)を使用することを推奨します。

## 作成されたサーバーの確認
サーバーを構成してから実行すると、設定した数だけサーバーが作成されます。作成されたサーバーは**TRANSIT**状態で起動し、黄色で表示されます。サーバーが**RUNNING**状態になるまで、NHN Cloudのインフラ状態によって数分(1～60分以上)かかる場合があります。 特に、GameAnvilサービスが最初のサーバーを駆動する際には、基本的なインフラ設定を同時に行うため、少し長い時間がかかる場合があります。ユーザーはこの時間の間、他の種類のサーバーを追加構成したり、他のメニューを使用できます。

サーバーが正常に動作されると、画像のように**RUNNING**状態に変わります。このように生成されたサーバーをクリックすると、次のようにサーバー情報を確認できます。この時、ユーザーはサーバー制御コマンドを使用して、そのサーバーを終了させて削除したり、再起動などを行うことができます。 あるいは、複数選択ボタンを使用して、一度に複数のサーバーを同時に選択してコマンドを実行することもできます。

![図](https://static.toastoven.net/prod_gameanvil/images/console/new-server/created.png)

サーバーリストで任意の項目をクリックすると、サーバーの詳細情報を確認できます。

![図](https://static.toastoven.net/prod_gameanvil/images/console/new-server/detail.png)


## 作成されたノード情報の確認

作成されたサーバーを構成する全てのノード情報はノードタブで確認できます。

**状態**、**ノードタイプ**、**サーバータイプ**だけでなく、**ノードID**など、より詳細で明確な情報に基づいて任意のノード情報だけをフィルタリングすることもできます。
![図](https://static.toastoven.net/prod_gameanvil/images/console/new-server/node.png)

## ロードバランサー

GameAnvilサービスはクライアントの接続を効率的に処理するためにロードバランサーを連動します。GameAnvilのノードのうち、クライアントが接続できるポイントはゲートウェイノードとサポートノードです。 そして、これらはすべて複数のインスタンスで構成できます。この時、複数の接続ポイントは、適切な負荷分散のためにロードバランサーと連動する必要があります。 また、そのロードバランサーは外部から接続可能なFloating IPに接続する必要があります。

![図](https://static.toastoven.net/prod_gameanvil/images/console/new-server/lb.png)

このような一連の過程はGameAnvilサービスで自動的に処理され、**ロードバランサー情報**をクリックして接続情報を確認できます。この情報はクライアントの接続アドレス/ポートペアなので、不必要に外部に伝わらないように注意する必要があります。
