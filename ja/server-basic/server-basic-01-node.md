## Game > GameAnvil > サーバー概念説明 > ノード



## Node

GameAnvilサーバー構成の最も基本となる単位はノードです。各ノードはその役割に合った機能を独立して実行します。 いくつのノードでどのような役割を実行するかは自由に設定可能です。ノードを詳しく説明する前に、役割別にノードを分類すると次のとおりです。 

| ノード     | 必須/選択    | 機能                                      | コンテンツ実装 | ネットワークアクセス     |
| ---------- |------------| ------------------------------------------- | ----------- | ------------------- |
| Gateway    | 必須       | クライアント接続と認証を処理             | 可能      | public              |
| Game       | 必須         | 実際のゲームサーバーとしてコンテンツを処理             | 可能        | private             |
| Support    | 任意         | 必要に応じて独立したサービスとして実装できるよう支援 | 可能        | private または public |
| Match      | 任意         | マッチメイキングを実行                           | 可能        | private             |
| Location   | 必須(自動構成) | ユーザーやルームなどの位置情報を保存及び管理      | 不可      | private             |
| Management | 必須(自動構成) | サーバー情報の収集及びConsole/Agentと通信       | 不可      | private             |
| Ipc        | 必須(自動構成) | GameAnvilサーバーのInter-process通信処理    | 不可      | private             |

特にユーザーはこの中でコンテンツ実装が可能なノード(Gateway、Game、Support、Match)にのみ集中すればよいです。残りはエンジンが内部的に使用し、ユーザーが追加で実装する部分はありません。また、必須ノードは必ず1つ以上存在する必要があり、全体サーバーが正常に稼働可能です。この時、Locationノードは明示的にGameAnvilConfig.jsonに宣言が必要です。

このようなノードの階層構造は下の図のような姿です。

![Node Layer.png](https://static.toastoven.net/prod_gameanvil/images/NodeLayer.png)



## シングルスレッド (Single-Threaded)

GameAnvilでは1つのノードは1つのスレッドで処理されます。これは非常に重要です。各ノードは基本的に全ての処理を非同期的に行う必要があり、このノードスレッドはブロッキングなしで持続的に稼働することが保証されなければなりません。このような稼働モデルはVert.xやNode.jsのそれと非常に似ています。

シングルスレッドの最大の長所はやはりLock-Freeです。ユーザーは特殊な場合を除いては明示的にロックを使用する必要がなく、使用してもいけません。ロックを使った瞬間、該当ノードスレッドが処理を止める可能性があります。これは該当ノード全体のロジックが止まることを意味するため、GameAnvilで開発する時は絶対にノードスレッドに対してロックを使用してはいけません。したがってノードスレッドと外部スレッドの間には絶対にゲーム関連オブジェクトが共有されてはいけません。ただし、別途外部スレッドを作成して作業を委任する場合、外部スレッド間のロックは関係ありません。もし外部スレッドに作業を委任したり、委任した作業の結果を取得する必要がある時は、GameAnvilで提供する[非同期サポートAPI](../server-impl/server-impl-10-async.md)を使用してください。
